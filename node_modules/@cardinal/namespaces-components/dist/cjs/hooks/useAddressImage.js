"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useAddressImage = void 0;
const tslib_1 = require("tslib");
const namespaces_1 = require("@cardinal/namespaces");
const react_1 = require("react");
const format_1 = require("../utils/format");
const useAddressName_1 = require("./useAddressName");
const useAddressImage = (connection, address, dev) => {
    const [addressImage, setAddressImage] = (0, react_1.useState)(undefined);
    const [loadingImage, setLoadingImage] = (0, react_1.useState)(true);
    const { displayName, loadingName } = (0, useAddressName_1.useAddressName)(connection, address);
    const refreshImage = (displayName) => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
        try {
            setLoadingImage(true);
            const [_namespace, handle] = displayName ? (0, namespaces_1.breakName)(displayName) : [];
            if (handle) {
                const imageUrl = yield (0, format_1.tryGetImageUrl)(handle, dev);
                setAddressImage(imageUrl);
            }
            else {
                setAddressImage(undefined);
            }
        }
        finally {
            setLoadingImage(false);
        }
    });
    (0, react_1.useMemo)(() => {
        void refreshImage(displayName);
    }, [displayName]);
    return { addressImage, loadingImage: loadingImage || loadingName };
};
exports.useAddressImage = useAddressImage;
//# sourceMappingURL=useAddressImage.js.map